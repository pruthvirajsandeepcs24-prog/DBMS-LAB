show databases;
create database if not exists bank_1;
use bank_1;
desc branch;
create table branch(branch_name varchar(20), branch_city varchar(20), assets real, primary key(branch_name));
drop table BankAccount;
create table BankAccount(Accno int, branch_name varchar(20), balance real, primary key(Accno));
create table BankCustomer(customer_name varchar(20), customer_street varchar(20), customer_city varchar(20), primary key(customer_name));
create table Depositer(customer_name varchar(20), Accno int, primary key(customer_name, Accno), foreign key(customer_name) references BankCustomer(customer_name), foreign key(Accno) references BankAccount(Accno));
create table Loan(loan_number int, branch_name varchar(20), amount real, primary key(loan_number));
insert into branch values("SBI_Chamrajpet","Bangalore",50000);
insert into branch values("SBI_ResidencyRoad","Bangalore",10000);
insert into branch values("SBI_ShivajiRoad","Bombay",20000);
insert into branch values("SBI_ParliamentRoad","Delhi",10000);
insert into branch values("SBI_Jantarmantar","Delhi",20000);
insert into BankAccount values(1,"SBI_Chamrajpet",2000);
insert into BankAccount values(2,"SBI_ResidencyRoad",5000);
insert into BankAccount values(3,"SBI_ShivajiRoad",6000);
insert into BankAccount values(4,"SBI_ParliamentRoad",9000);
insert into BankAccount values(5,"SBI_Jantarmantar",8000);
insert into BankAccount values(6,"SBI_ShivajiRoad",4000);
insert into BankAccount values(7,"SBI_ResidencyRoad",3000);
insert into BankAccount values(8,"SBI_ParliamentRoad",9000);
insert into BankAccount values(9,"SBI_Jantarmantar",2000);
alter table BankAccount add constraint ck1 foreign key(branch_name) references branch(branch_name);
alter table Loan add constraint ck2 foreign key(branch_name) references branch(branch_name);
insert into BankCustomer values("Avinash","Bull_Temple_Road","Bangalore");
insert into BankCustomer values("Dinesh","Bannergatta_Road","Bangalore");
insert into BankCustomer values("Mohan","NationalCollege_Road","Bangalore");
insert into BankCustomer values("Nikil","Akbar_Road","Delhi");
insert into BankCustomer values("Ravi","Prithviraj_Road","Delhi");
insert into Depositer values("Avinash",1);
insert into Depositer values("Dinesh",2);
insert into Depositer values("Nikil",4);
insert into Depositer values("Ravi",5);
insert into Depositer values("Avinash",3);
insert into Depositer values("Nikil",6);
insert into Depositer values("Dinesh",8);
insert into Depositer values("Ravi",9);
insert into Loan values(1,"SBI_Chamrajpet",1000);
insert into Loan values(2,"SBI_ResidencyRoad",2000);
insert into Loan values(3,"SBI_ShivajiRoad",3000);
insert into Loan values(4,"SBI_ParliamentRoad",4000);
insert into Loan values(5,"SBI_Jantarmantar",5000);
select * from BankCustomer;
select branch_name, ((assets / 100000)) as 'Assets in Lakhs' from branch;
select d.customer_name, a.branch_name, count(d.Accno) as no_of_accounts from Depositer d join BankAccount a on d.Accno = a.Accno group by d.customer_name, a.branch_name having count(d.Accno) >= 2;
create view view_loan as select branch_name, sum(amount) as total_loan from Loan group by branch_name;
select * from view_loan;
show databases;

create database IF NOT exists employee;

show databases;

use employee;

CREATE TABLE DEPT (DEPTNO INT PRIMARY KEY,DNAME VARCHAR(30),DLOC VARCHAR(30));

CREATE TABLE EMPLOYEE (EMPNO INT PRIMARY KEY,ENAME VARCHAR(30),MGR_NO INT,HIREDATE DATE,SAL DECIMAL(10, 2),DEPTNO INT,FOREIGN KEY (DEPTNO) REFERENCES DEPT(DEPTNO));

CREATE TABLE PROJECT (PNO INT PRIMARY KEY,PNAME VARCHAR(30),PLOC VARCHAR(30));

CREATE TABLE INCENTIVES (EMPNO INT,INCENTIVE_DATE DATE,INCENTIVE_AMOUNT DECIMAL(10, 2),PRIMARY KEY (EMPNO, INCENTIVE_DATE),FOREIGN KEY (EMPNO) REFERENCES EMPLOYEE(EMPNO));

CREATE TABLE ASSIGNED_TO (EMPNO INT,PNO INT,JOB_ROLE VARCHAR(30),PRIMARY KEY (EMPNO, PNO),FOREIGN KEY (EMPNO) REFERENCES EMPLOYEE(EMPNO),FOREIGN KEY (PNO) REFERENCES PROJECT(PNO));

INSERT INTO  DEPT VALUES (1,"IT","BENGALURU"),(2,"HR","HYDERABAD"),(3,"SALES","MYSURU"),(4,"FINANCE","BENGALURU"),(5,"ACCOUNT","HYDERABAD");

INSERT INTO  EMPLOYEE VALUES (11,"PRINCE",20,"2025-1-2",50000,1),(12,"ROHAN", 21,"2023-3-5",60000,2),(13,"PARTH", 21,"2025-4-1",23000,3),(14,"PRUTHVI",23,"2020-3-8",80000,4),(15,"PRERIT", 20,"2025-7-13",20000,5);

INSERT INTO  PROJECT VALUES (51,"PROJECT A","BENGALURU"),(52,"PROJECT B","HYDERBAD"),(53, "PROJECT C","MYSURU"),(54,"PROJECT D","BENGALURU"),(55,"PROJECT E","HYDERABAD");

INSERT INTO  INCENTIVES VALUES (11,"2025-2-2",5000),(12,"2025-2-2",6000),(13,"2025-5-1",2300),(14,"2021-3-8",20000),(15,"2025-8-13",2000);

INSERT INTO  ASSIGNED_TO VALUES(11,51,"HR"),(12,52,"TESTER"),(13,53,"DEVELOPER"),(14,54,"MANAGER"),(15,55,"ANALYST");

SELECT DISTINCT A.EMPNO
FROM ASSIGNED_TO A
JOIN PROJECT P ON A.PNO=P.PNO
WHERE P.PLOC IN ("BENGALURU","HYDERABAD","MYSURU");

SELECT EMPNO
FROM EMPLOYEE 
WHERE EMPNO NOT IN (SELECT EMPNO FROM INCENTIVES);

SELECT E.ENAME, E.EMPNO, E.DEPTNO, A.JOB_ROLE, D.DLOC AS DEPT_LOCATION, P.PLOC AS PROJECT_LOCATION
FROM EMPLOYEE E
JOIN ASSIGNED_TO A ON E.EMPNO = A.EMPNO
JOIN PROJECT P ON A.PNO = P.PNO
JOIN DEPT D ON E.DEPTNO = D.DEPTNO
WHERE P.PLOC = D.DLOC;



